# üöÄ Complete Deployment Checklist

## Pre-Deployment Status

‚úÖ Backend code pushed to GitHub
‚úÖ Frontend code pushed to GitHub  
‚úÖ JWT secrets generated
‚úÖ Documentation created

## Step-by-Step Deployment

### 1Ô∏è‚É£ Deploy Backend to Railway (15 minutes)

#### A. Connect GitHub to Railway
- [ ] Go to https://railway.app/
- [ ] Sign in with GitHub
- [ ] Profile ‚Üí Settings ‚Üí Connected Accounts
- [ ] Reconnect GitHub if needed
- [ ] **IMPORTANT**: Grant access to `websupport-ttp` organization

#### B. Create New Project
- [ ] Click "New Project"
- [ ] Select "Deploy from GitHub repo"
- [ ] Choose `websupport-ttp/ttp-saas-backend`

#### C. Add Databases
- [ ] Click "New" ‚Üí "Database" ‚Üí "Add MongoDB"
- [ ] Click "New" ‚Üí "Database" ‚Üí "Add Redis"
- [ ] Wait for databases to provision

#### D. Add Environment Variables
Copy from `GENERATED_SECRETS.md` and add:

```env
NODE_ENV=production
PORT=8080
MONGODB_URI=<auto-generated by Railway>
REDIS_URL=<auto-generated by Railway>

# JWT Secrets (from GENERATED_SECRETS.md)
JWT_ACCESS_SECRET=f6b3ccca6564f4a67f437de7031f80fd87eace9ecf942c16963a558bc49c9aeb5cd82fb81100c58e9116f68b3f028a1456e1db18c08456321c6e817a54aa1ddf
JWT_SECRET=9023d5a47c310a00270a23807327683000083f514c785b0a6695108c01e8cba50ddbc30d20efb8c98ce8505a8803bacc7486f0c287c075b19aa8db0aae0dcabc
JWT_EXPIRE=30d
COOKIE_SECRET=2840634d7035e0acc8be472a4b59629124c050359519a02e56191fbba9f693b0

# Cloudinary (get from cloudinary.com)
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

# Paystack (get from paystack.com)
PAYSTACK_SECRET_KEY=sk_test_your_secret_key
PAYSTACK_PUBLIC_KEY=pk_test_your_public_key

# CORS (add after deploying frontend)
ALLOWED_ORIGINS=https://your-app.vercel.app
```

#### E. Deploy and Test
- [ ] Click "Deploy"
- [ ] Wait for build to complete
- [ ] Copy Railway URL (e.g., `https://ttp-saas-backend-production.up.railway.app`)
- [ ] Test health endpoint: `https://YOUR-RAILWAY-URL.up.railway.app/health`
- [ ] Should return: `{"status":"ok"}`

---

### 2Ô∏è‚É£ Deploy Frontend to Vercel (10 minutes)

#### A. Import Project
- [ ] Go to https://vercel.com/
- [ ] Sign in with GitHub
- [ ] Click "Add New..." ‚Üí "Project"
- [ ] Import `websupport-ttp/ttp-saas-frontend`

#### B. Configure Project
- [ ] Framework Preset: Next.js (auto-detected)
- [ ] Root Directory: `./` (leave as default)
- [ ] Build Command: `npm run build` (auto-detected)
- [ ] Output Directory: `.next` (auto-detected)

#### C. Add Environment Variables
Use your Railway URL from Step 1:

```env
NEXT_PUBLIC_SITE_NAME=The Travel Place
NEXT_PUBLIC_SITE_URL=https://your-app.vercel.app
NEXT_PUBLIC_SITE_DESCRIPTION=Discover amazing destinations and plan your perfect trip with The Travel Place - your trusted travel companion for flights, hotels, visa applications, and travel insurance.
NEXT_PUBLIC_API_BASE_URL=https://YOUR-RAILWAY-URL.up.railway.app/api/v1
NEXT_PUBLIC_API_TIMEOUT=30000
NEXT_PUBLIC_AUTH_COOKIE_NAME=ttp_auth_token
NEXT_PUBLIC_REFRESH_TOKEN_NAME=ttp_refresh_token
NEXT_PUBLIC_PAYSTACK_PUBLIC_KEY=pk_test_94c934b4b9a13be250eff78151e924c031ae9344
NEXT_PUBLIC_DEBUG_MODE=false
NEXT_PUBLIC_SHOW_PERFORMANCE_METRICS=false
NEXT_PUBLIC_ENABLE_GUEST_CHECKOUT=true
NEXT_PUBLIC_ENABLE_REAL_TIME_UPDATES=true
```

**Note**: For each variable, select "Production", "Preview", and "Development" environments

#### D. Deploy
- [ ] Click "Deploy"
- [ ] Wait for build to complete (2-5 minutes)
- [ ] Copy Vercel URL (e.g., `https://ttp-saas-frontend.vercel.app`)

---

### 3Ô∏è‚É£ Update CORS Settings (2 minutes)

#### A. Update Railway Backend
- [ ] Go back to Railway dashboard
- [ ] Select your backend project
- [ ] Go to "Variables" tab
- [ ] Update `ALLOWED_ORIGINS` variable:
  ```
  ALLOWED_ORIGINS=https://your-app.vercel.app,https://your-app-*.vercel.app
  ```
- [ ] Save changes
- [ ] Railway will auto-redeploy

#### B. Update Vercel Frontend (if needed)
- [ ] Go to Vercel dashboard
- [ ] Select your project
- [ ] Go to "Settings" ‚Üí "Environment Variables"
- [ ] Update `NEXT_PUBLIC_SITE_URL` with your actual Vercel URL
- [ ] Redeploy from "Deployments" tab

---

### 4Ô∏è‚É£ Test Deployment (10 minutes)

#### Backend Tests
- [ ] Visit: `https://YOUR-RAILWAY-URL.up.railway.app/health`
  - Should return: `{"status":"ok"}`
- [ ] Visit: `https://YOUR-RAILWAY-URL.up.railway.app/api/v1`
  - Should return API info
- [ ] Check Railway logs for errors

#### Frontend Tests
- [ ] Visit: `https://your-app.vercel.app`
  - Homepage should load
- [ ] Test login:
  - Click "Login" button
  - Try logging in with test credentials
- [ ] Test dashboard:
  - Should redirect to appropriate dashboard
  - Check if data loads
- [ ] Test profile:
  - Go to Profile Settings
  - Try uploading profile picture
- [ ] Test visa form:
  - Fill out visa assistance form
  - Check if Paystack integration works
- [ ] Test car hire:
  - Fill out car hire form
  - Check if booking works

#### Browser Console Tests
- [ ] Open browser DevTools (F12)
- [ ] Check Console for errors
- [ ] Check Network tab:
  - API calls should go to Railway URL
  - No CORS errors
  - Status codes should be 200 or appropriate

---

## üéØ Success Criteria

### Backend (Railway)
‚úÖ Health check returns OK
‚úÖ API endpoints respond
‚úÖ MongoDB connected
‚úÖ Redis connected
‚úÖ No errors in logs
‚úÖ Environment variables set

### Frontend (Vercel)
‚úÖ Homepage loads
‚úÖ Login works
‚úÖ Dashboard loads
‚úÖ API calls reach Railway
‚úÖ No CORS errors
‚úÖ Profile picture upload works
‚úÖ Paystack integration works

---

## üêõ Common Issues & Solutions

### Issue: CORS Error
**Symptom**: Browser console shows CORS error
**Solution**: 
1. Check Railway `ALLOWED_ORIGINS` includes Vercel URL
2. Ensure URL format is correct (no trailing slash)
3. Redeploy Railway backend

### Issue: API calls go to localhost
**Symptom**: Network tab shows calls to localhost:8080
**Solution**:
1. Check Vercel env variable `NEXT_PUBLIC_API_BASE_URL`
2. Ensure it points to Railway URL
3. Redeploy Vercel frontend

### Issue: 404 on API calls
**Symptom**: All API calls return 404
**Solution**:
1. Verify Railway backend is running
2. Check Railway URL is correct
3. Ensure `/api/v1` is included in URL

### Issue: Login fails
**Symptom**: Login returns error
**Solution**:
1. Check Railway logs for errors
2. Verify JWT secrets are set
3. Check MongoDB connection
4. Verify CORS settings

### Issue: Profile picture upload fails
**Symptom**: Upload returns error
**Solution**:
1. Check Cloudinary credentials in Railway
2. Verify Cloudinary account is active
3. Check Railway logs for Cloudinary errors

### Issue: Paystack not working
**Symptom**: Payment modal doesn't open
**Solution**:
1. Verify Paystack public key in Vercel
2. Check Paystack secret key in Railway
3. Ensure Paystack account is active

---

## üìä Deployment URLs

### Your URLs (Fill in after deployment)

**Railway Backend**:
```
https://_____________________________.up.railway.app
```

**Vercel Frontend**:
```
https://_____________________________.vercel.app
```

---

## üìö Reference Documents

- `GENERATED_SECRETS.md` - All JWT and security secrets
- `VERCEL_ENV_VARIABLES.md` - Complete Vercel configuration
- `RAILWAY_VERCEL_DEPLOYMENT_GUIDE.md` - Detailed deployment guide
- `QUICK_DEPLOYMENT_STEPS.md` - Fast track guide
- `QUICK_COMMANDS.md` - Useful commands reference

---

## ‚è±Ô∏è Estimated Time

- Railway Backend: 15 minutes
- Vercel Frontend: 10 minutes
- CORS Update: 2 minutes
- Testing: 10 minutes
- **Total: ~40 minutes**

---

## üéâ After Successful Deployment

1. Share the Vercel URL with your team
2. Update DNS if using custom domain
3. Set up monitoring (optional)
4. Configure analytics (optional)
5. Set up error tracking (optional)
6. Create backup strategy
7. Document any custom configurations

---

**Ready to deploy?** Start with Railway, then Vercel! üöÄ
